program conditional_probability
    use iso_fortran_env   								! Подключение модуля, который предоставляет типы данных с фиксированными размерами (например, int64).
    implicit none         								! Отключение неявного определения типов для повышения безопасности кода (все переменные должны быть явно объявлены).

    ! Параметры
    integer(int64) :: num_trials = 100000  						! Количество симуляций (бросков двух костей), определенное как 100 000.
    integer(int64) :: i                    						! Переменная-счетчик для цикла, управляющего количеством бросков.
    integer(int64) :: die1, die2           						! Переменные для хранения значений бросков двух костей.
    integer(int64) :: total                						! Переменная для хранения суммы очков, выпавших на двух костях.
    integer(int64) :: even_sum_count       						! Счетчик для количества случаев, когда сумма двух костей четная (событие B).
    integer(int64) :: event_a_count        						! Счетчик для количества случаев, когда сумма двух костей равна 8 (событие A).
    real :: probability                    						! Переменная для хранения вычисленной условной вероятности P(A|B).

    ! Инициализация счётчиков
    even_sum_count = 0   								! Инициализируем счетчик четных сумм (B) на 0.
    event_a_count = 0    								! Инициализируем счетчик случаев, когда сумма равна 8 (A), на 0.

    ! Генерация случайных бросков двух костей
    do i = 1, num_trials  								! Цикл повторяется num_trials (100 000) раз.
        die1 = int(6 * random_value() + 1)  						! Генерируем случайное значение для первой кости от 1 до 6.
        die2 = int(6 * random_value() + 1)  						! Генерируем случайное значение для второй кости от 1 до 6.

        total = die1 + die2  								! Вычисляем сумму очков, выпавших на двух костях.

        ! Проверяем, выполняется ли событие B (четная сумма)
        if (mod(total, 2) == 0) then  							! Если сумма четная (остаток от деления на 2 равен 0).
            even_sum_count = even_sum_count + 1  					! Увеличиваем счетчик событий с четной суммой (событие B).

            ! Проверяем выполнение события A (сумма равна 8)
            if (total == 8) then  							! Если сумма двух костей равна 8.
                event_a_count = event_a_count + 1  					! Увеличиваем счетчик событий, где сумма равна 8 (событие A).
            end if
        end if
    end do

    ! Вычисление условной вероятности P(A|B)
    probability = real(event_a_count) / real(even_sum_count)  				! Условная вероятность P(A|B): отношение количества случаев A к количеству случаев B.

    ! Вывод результата
    print *, 'Условная вероятность P(A|B): ', probability  				! Печать результата на экран.

contains

    ! Функция для генерации случайного числа от 0 до 1
    real function random_value()  							! Определение функции для генерации случайного числа.
        real :: u
        call random_number(u)  								! Вызов встроенной функции Fortran для генерации случайного числа между 0 и 1.
        random_value = u       								! Возврат сгенерированного числа.
    end function random_value

end program conditional_probability  							! Конец программы.
